Sub GetConditionalFormattingCode()
    Dim rng As Range
    Dim cfRule As FormatCondition
    Dim i As Integer
    
    ' Set the range to the selected range in the active sheet
    Set rng = Selection
    
    ' Loop through each conditional formatting rule in the range
    For Each cfRule In rng.FormatConditions
        ' Check if the rule is a unique values rule
        If cfRule.Type = xlUniqueValues Then
            ' Print the conditional formatting code to the immediate window
            Debug.Print "With rng.FormatConditions(" & i + 1 & ")"
            Debug.Print "    .Type = xlUniqueValues"
            Debug.Print "    .DupeUnique = xlDuplicate"
            Debug.Print "    .Interior.Color = RGB(255, 253, 208)"
            Debug.Print "    .Font.Color = RGB(255, 0, 0)"
            Debug.Print "End With"
            
            ' Exit the loop after finding the first unique values rule
            Exit For
        End If
        
        i = i + 1
    Next cfRule
End Sub
